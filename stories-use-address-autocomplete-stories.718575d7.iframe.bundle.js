"use strict";(self.webpackChunkuse_address_autocomplete=self.webpackChunkuse_address_autocomplete||[]).push([[16],{"./src/stories/use-address-autocomplete.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>use_address_autocomplete_stories});var react=__webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");function c(e,u,c){var i=this,a=(0,react.useRef)(null),o=(0,react.useRef)(0),f=(0,react.useRef)(null),l=(0,react.useRef)([]),v=(0,react.useRef)(),m=(0,react.useRef)(),d=(0,react.useRef)(e),g=(0,react.useRef)(!0);d.current=e;var p="undefined"!=typeof window,w=!u&&0!==u&&p;if("function"!=typeof e)throw new TypeError("Expected a function");u=+u||0;var s=!!(c=c||{}).leading,x=!("trailing"in c)||!!c.trailing,h="maxWait"in c,y="debounceOnServer"in c&&!!c.debounceOnServer,F=h?Math.max(+c.maxWait||0,u):null;(0,react.useEffect)((function(){return g.current=!0,function(){g.current=!1}}),[]);var A=(0,react.useMemo)((function(){var r=function(r){var n=l.current,t=v.current;return l.current=v.current=null,o.current=r,m.current=d.current.apply(t,n)},n=function(r,n){w&&cancelAnimationFrame(f.current),f.current=w?requestAnimationFrame(r):setTimeout(r,n)},t=function(r){if(!g.current)return!1;var n=r-a.current;return!a.current||n>=u||n<0||h&&r-o.current>=F},e=function(n){return f.current=null,x&&l.current?r(n):(l.current=v.current=null,m.current)},c=function r(){var c=Date.now();if(t(c))return e(c);if(g.current){var i=u-(c-a.current),f=h?Math.min(i,F-(c-o.current)):i;n(r,f)}},A=function(){if(p||y){var e=Date.now(),d=t(e);if(l.current=[].slice.call(arguments),v.current=i,a.current=e,d){if(!f.current&&g.current)return o.current=a.current,n(c,u),s?r(a.current):m.current;if(h)return n(c,u),r(a.current)}return f.current||n(c,u),m.current}};return A.cancel=function(){f.current&&(w?cancelAnimationFrame(f.current):clearTimeout(f.current)),o.current=0,l.current=a.current=v.current=f.current=null},A.isPending=function(){return!!f.current},A.flush=function(){return f.current?e(Date.now()):m.current},A}),[s,h,u,F,x,w,p,y]);return A}function _array_like_to_array(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _sliced_to_array(arr,i){return function _array_with_holes(arr){if(Array.isArray(arr))return arr}(arr)||function _iterable_to_array_limit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null!=_i){var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}}(arr,i)||function _unsupported_iterable_to_array(o,minLen){if(!o)return;if("string"==typeof o)return _array_like_to_array(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _array_like_to_array(o,minLen)}(arr,i)||function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _ts_generator(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function step(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}}function useAddressAutocomplete(adapter){var _ref_debounceTime=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).debounceTime,debounceTime=void 0===_ref_debounceTime?1e3:_ref_debounceTime,_React_useState=_sliced_to_array(react.useState(""),2),value=_React_useState[0],setValue=_React_useState[1],_React_useState1=_sliced_to_array(react.useState(!1),2),ready=_React_useState1[0],setReady=_React_useState1[1],_React_useState2=_sliced_to_array(react.useState(!1),2),loadingSuggestions=_React_useState2[0],setLoadingSuggestions=_React_useState2[1],_React_useState3=_sliced_to_array(react.useState(null),2),selectedAddress=_React_useState3[0],setSelectedAddress=_React_useState3[1],_React_useState4=_sliced_to_array(react.useState([]),2),suggestions=_React_useState4[0],setSuggestions=_React_useState4[1],getSuggestions=c((function(getSuggestionsValue){adapter.getSuggestions(getSuggestionsValue).then((function(returnedSuggestions){setSuggestions(returnedSuggestions)})).finally((function(){setLoadingSuggestions(!1)}))}),debounceTime);return(0,react.useEffect)((function(){function _doInit(){return _doInit=function _async_to_generator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}((function(){return _ts_generator(this,(function(_state){switch(_state.label){case 0:return _state.trys.push([0,2,,3]),[4,adapter.init()];case 1:return _state.sent(),setReady(!0),[2,!0];case 2:return _state.sent(),[2,!1];case 3:return[2]}}))})),_doInit.apply(this,arguments)}!function doInit(){_doInit.apply(this,arguments)}()}),[]),{value,setValue:function(newValue){setLoadingSuggestions(!0),setValue(newValue),getSuggestions(newValue)},ready,loadingSuggestions,suggestions,selectedAddress,selectSuggestion:function(suggestion){adapter.getAddressComponents(suggestion).then((function(addressComponents){setSelectedAddress(addressComponents),setValue(suggestion.text),setSuggestions([])})).catch(console.error)}}}const esm_browser_native={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&!(getRandomValues="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}for(var byteToHex=[],stringify_i=0;stringify_i<256;++stringify_i)byteToHex.push((stringify_i+256).toString(16).slice(1));function unsafeStringify(arr,offset=0){return(byteToHex[arr[offset+0]]+byteToHex[arr[offset+1]]+byteToHex[arr[offset+2]]+byteToHex[arr[offset+3]]+"-"+byteToHex[arr[offset+4]]+byteToHex[arr[offset+5]]+"-"+byteToHex[arr[offset+6]]+byteToHex[arr[offset+7]]+"-"+byteToHex[arr[offset+8]]+byteToHex[arr[offset+9]]+"-"+byteToHex[arr[offset+10]]+byteToHex[arr[offset+11]]+byteToHex[arr[offset+12]]+byteToHex[arr[offset+13]]+byteToHex[arr[offset+14]]+byteToHex[arr[offset+15]]).toLowerCase()}const esm_browser_v4=function v4(options,buf,offset){if(esm_browser_native.randomUUID&&!buf&&!options)return esm_browser_native.randomUUID();var rnds=(options=options||{}).random||(options.rng||rng)();if(rnds[6]=15&rnds[6]|64,rnds[8]=63&rnds[8]|128,buf){offset=offset||0;for(var i=0;i<16;++i)buf[offset+i]=rnds[i];return buf}return unsafeStringify(rnds)};function _define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){_define_property(target,key,source[key])}))}return target}function _object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function map_box_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function map_box_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){map_box_define_property(target,key,source[key])}))}return target}function map_box_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function map_box_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}function use_address_autocomplete_stories_define_property(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function use_address_autocomplete_stories_object_spread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{},ownKeys=Object.keys(source);"function"==typeof Object.getOwnPropertySymbols&&(ownKeys=ownKeys.concat(Object.getOwnPropertySymbols(source).filter((function(sym){return Object.getOwnPropertyDescriptor(source,sym).enumerable})))),ownKeys.forEach((function(key){use_address_autocomplete_stories_define_property(target,key,source[key])}))}return target}function use_address_autocomplete_stories_object_spread_props(target,source){return source=null!=source?source:{},Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):function use_address_autocomplete_stories_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})),target}var Demo=function(param){var apiKey,options,adapter=param.adapter,googleApiKey=param.googleApiKey,mapBoxApiKey=param.mapBoxApiKey,googlePlacesAdapter=(apiKey=googleApiKey,options={suggestRequestOptions:{origin:{latitude:37.7749,longitude:-122.4194}}},{init:function init(){if(!apiKey)return Promise.reject(console.error("Google API key is required"));var newSessionToken=esm_browser_v4();return this.sessionToken=newSessionToken,window.sessionStorage.setItem("mapboxSessionToken",newSessionToken),Promise.resolve()},getSuggestions:function getSuggestions(query){return fetch("https://places.googleapis.com/v1/places:autocomplete?key=".concat(apiKey),{method:"POST",body:JSON.stringify(_object_spread_props(_object_spread({},null==options?void 0:options.suggestRequestOptions),{input:query,sessionToken:this.sessionToken}))}).then((function(response){return response.json()})).then((function(param){return param.suggestions.map((function(suggestion){return{id:suggestion.placePrediction.placeId,text:suggestion.placePrediction.text.text}}))}))},getAddressComponents:function getAddressComponents(suggestion){var searchParams=new URLSearchParams(_object_spread_props(_object_spread({},null==options?void 0:options.placeDetailsRequestOptions),{fields:"id,addressComponents,location",key:apiKey,sessionToken:this.sessionToken}));return fetch("https://places.googleapis.com/v1/places/".concat(suggestion.id,"?").concat(searchParams.toString())).then((function(response){return response.json()})).then((function(response){var addressComponentsByType=response.addressComponents.reduce((function(obj,component){var updates={};return component.types.forEach((function(type){updates[type]=component.shortText||component.longText||""})),_object_spread({},obj,updates)}),{});return{address1:"".concat(addressComponentsByType.street_number," ").concat(addressComponentsByType.route),address2:"",city:addressComponentsByType.locality,state:addressComponentsByType.administrative_area_level_1,postalCode:addressComponentsByType.postal_code,country:addressComponentsByType.country,id:response.id,location:response.location}}))}}),mapBoxAdapter=function(accessToken,options){return{init:function init(){if(!accessToken)return Promise.reject(console.error("MapBox API key is required"));var newSessionToken=esm_browser_v4();return this.sessionToken=newSessionToken,window.sessionStorage.setItem("mapboxSessionToken",newSessionToken),Promise.resolve()},getSuggestions:function getSuggestions(query){var searchParams=new URLSearchParams(map_box_object_spread_props(map_box_object_spread({},null==options?void 0:options.suggestRequestOptions),{q:query,access_token:accessToken,session_token:this.sessionToken}));return fetch("https://api.mapbox.com/search/searchbox/v1/suggest?".concat(searchParams.toString())).then((function(res){return res.json()})).then((function(res){return res.suggestions.map((function(suggestion){return{id:suggestion.mapbox_id,text:suggestion.full_address}}))}))},getAddressComponents:function getAddressComponents(suggestion){var searcParams=new URLSearchParams(map_box_object_spread_props(map_box_object_spread({},null==options?void 0:options.retrieveRequestOptions),{access_token:accessToken,session_token:this.sessionToken}));return fetch("https://api.mapbox.com/search/searchbox/v1/retrieve/".concat(suggestion.id,"?").concat(searcParams.toString())).then((function(res){return res.json()})).then((function(res){var addressFeature=res.features[0];return{address1:addressFeature.properties.context.address.name,address2:"",city:addressFeature.properties.context.place.name,country:addressFeature.properties.context.country.name,postalCode:addressFeature.properties.context.postcode.name,state:addressFeature.properties.context.region.region_code,id:suggestion.id,location:{latitude:addressFeature.geometry.coordinates[1],longitude:addressFeature.geometry.coordinates[0]}}}))}}}(mapBoxApiKey),_useAddressAutocomplete=useAddressAutocomplete("google"===adapter?googlePlacesAdapter:mapBoxAdapter),value=_useAddressAutocomplete.value,setValue=_useAddressAutocomplete.setValue,ready=_useAddressAutocomplete.ready,loadingSuggestions=_useAddressAutocomplete.loadingSuggestions,suggestions=_useAddressAutocomplete.suggestions,selectSuggestion=_useAddressAutocomplete.selectSuggestion,selectedAddress=_useAddressAutocomplete.selectedAddress;return react.createElement("div",{style:{display:"flex",flexDirection:"column",gap:8,width:"25%"}},react.createElement("label",{htmlFor:"autocomplete-".concat(adapter)},adapter),react.createElement("input",{id:"autocomplete-".concat(adapter),value,onChange:function(e){setValue(e.target.value)},disabled:!ready}),loadingSuggestions&&react.createElement("p",null,"Loading suggestions..."),suggestions.length>0&&react.createElement("aside",null,suggestions.map((function(suggestion){return react.createElement("button",{type:"button",style:{background:"transparent",display:"block",border:"none",textAlign:"left"},onClick:function(){return selectSuggestion(suggestion)},key:suggestion.id,"data-test":suggestion},suggestion.text)}))),selectedAddress&&react.createElement("section",null,react.createElement("h2",null,"Selected Address"),react.createElement("pre",null,JSON.stringify(selectedAddress,null,2))))};const use_address_autocomplete_stories={title:"useAddressAutocomplete",component:Demo,argTypes:{googleApiKey:{description:"Google Places API Key (press the reload icon at the top after setting this)",control:{type:"text"}},mapBoxApiKey:{description:"MapBox API Key (press the reload icon at the top after setting this)",control:{type:"text"}}},parameters:{controls:{expanded:!0}}};var Default=function(args){return react.createElement("div",{style:{display:"flex",gap:16}},react.createElement(Demo,use_address_autocomplete_stories_object_spread_props(use_address_autocomplete_stories_object_spread({},args),{adapter:"google"})),react.createElement(Demo,use_address_autocomplete_stories_object_spread_props(use_address_autocomplete_stories_object_spread({},args),{adapter:"mapbox"})))}.bind({});Default.args={},Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:'args => <div style={{\n  display: "flex",\n  gap: 16\n}}>\n    <Demo {...args} adapter="google" />\n    <Demo {...args} adapter="mapbox" />\n  </div>',...Default.parameters?.docs?.source}}};const __namedExportsOrder=["Default"]}}]);